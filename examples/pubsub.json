{
    "name": "Let's do producers and consumers with mqtt",
    "scenarios": [ ["producer", "@producers"], ["consumer", "@consumers"] ],
    "sequencing": "Parallel",
    "globals": {
        "producers": 5,
        "consumers": 1,
        "iterations": 1000
    },
    "producer": [
        ["setUser", "foo@bar.com"],
        ["sync", "all subscribed", ["+", "@producers", "@consumers"]],
        ["repeat", "@iterations", 
            [
                ["publish", "/clearblade/test/spewer", "This is the spew", 1]
            ]
        ]
    ],
    "consumer": [
        ["setUser", "bar@bar.com"],
        ["subscribe", "/clearblade/test/spewer", 1],
        ["sync", "all subscribed", ["+", "@producers", "@consumers"]],
        ["repeat", ["*", "@iterations", "@producers"], 
            [
                ["waitMessage", "/clearblade/test/spewer", 100]
            ]
        ]
    ]
}
